EJBCA,Insta,description, -section,val, -server,val, -proxy,val, -path,val, -msg_timeout,int, -total_timeout,int, -tls_used,noarg, -tls_cert,val, -tls_key,val, -tls_keypass,val, -tls_trusted,val, -tls_host,valg, -no_proxy,val
,,,,Message transfer options:,,,,,,,,,,,TLS options:,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,,
0,0,default config, -section,,,,,,,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,
0,-,default config with TLS, -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,,-tls_used,, -tls_cert,EJBCACMPSignerTLS.p12, -tls_key,EJBCACMPSignerTLS.p12, -tls_keypass,pass:12345, -tls_trusted,EJBCAInfrastructureRootCAv10.crt,BLANK,
,,,,,,,,,,,,,,,,,,,,,,,,,,
1,1,wrong server, -section,, -server,example.com:_SERVER_PORT,,,,, -msg_timeout,1,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,
1,-,wrong server with TLS port, -section,, -server,example.com:_SERVER_TLS ,,,,, -msg_timeout,5,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,
1,1,wrong server port, -section,, -server,_SERVER_HOST:81,,,,, -msg_timeout,5,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,
1,1,server port out of range, -section,, -server,_SERVER_HOST:65536,,,,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,
1,1,server port negative, -section,, -server,_SERVER_HOST:-10,,,,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,
1,1,server missing arg, -section,, -server,,,,,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,
1,1,server with default port, -section,, -server,_SERVER_HOST,,,,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,
1, -,server IP address bad syntax: double '.', -section,, -server,127.0.0..1:_SERVER_PORT,,,,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,
-, -,server domain bad syntax: double '.', -section,, -server,ec2-204-236-244-127.compute-1.amazonaws..com:_SERVER_PORT,,,,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,
-,1,server port bad syntax: missing ':', -section,, -server,_SERVER_HOST.80,,,,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,
1,1,server port bad synatx: trailing garbage, -section,, -server,_SERVER_HOST:_SERVER_PORT+/x.,,,,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,
1,1,server with TLS port, -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,
,,,,,,,,,,,,,,,,,,,,,,,,,,
,,proxy tests only relevant for non-local server,,,,,,,,,,,,,,,,,,,,,,,,
-,-,proxy bad ipv4 address syntax: extra cell, -section,, -server,_SERVER_HOST:_SERVER_PORT, -proxy,127.0.0.0.0:8888,,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK, -no_proxy,nonmatch.com
-,1,proxy port out of range, -section,, -server,_SERVER_HOST:_SERVER_PORT, -proxy,127.0.0.1:65536,,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK, -no_proxy,nonmatch.com
-,-,proxy IP address bad syntax: double '.', -section,, -server,_SERVER_HOST:_SERVER_PORT, -proxy,127.0.0..1:8888,,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK, -no_proxy,nonmatch.com
-,-,proxy no port, -section,, -server,_SERVER_HOST:_SERVER_PORT, -proxy,127.0.0.1,,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK, -no_proxy,nonmatch.com
-,1,proxy missing arg, -section,, -server,_SERVER_HOST:_SERVER_PORT, -proxy,,,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK, -no_proxy,nonmatch.com
,,,,,,,,,,,,,,,,,,,,,,,,,,
0,0,path explicit, -section,, -server,_SERVER_HOST:_SERVER_PORT,,, -path,_SERVER_PATH,BLANK,,BLANK,,BLANK,,BLANK,
0,0,path overrides -server path, -section,, -server,_SERVER_HOST:_SERVER_PORT/ignored,,, -path,_SERVER_PATH,BLANK,,BLANK,,BLANK,,BLANK,
0,0,path default -server path, -section,, -server,_SERVER_HOST:_SERVER_PORT/_SERVER_PATH,,, -path,"""",BLANK,,BLANK,,BLANK,,BLANK,
1,1,path missing argument, -section,,,,,, -path,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,
1,1,path wrong, -section,,,,,, -path,/ejbca/publicweb/cmp/example,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,
0,0,path with additional '/'s fine according to RFC 3986, -section,,,,,, -path,/_SERVER_PATH////,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,
1,-,path mixed case, -section,,,,,, -path,/eJbCa/publicweb/cmp/ECCEndEntity,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,
-,1,path mixed case, -section,,,,,, -path,pKiX/,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,
1,-,path upper case, -section,,,,,, -path,/EJBCA/PUBLICWEB/CMP/ECCENDENTITY,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,
-,1,path upper case, -section,,,,,, -path,PKIX/,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,
,,,,,,,,,,,,,,,,,,,,,,,,,,
0,0,msg_timeout 5, -section,,,,,,,, -msg_timeout,5,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,
0,0,msg_timeout 0, -section,,,,,,,, -msg_timeout,0,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,
,,,,,,,,,,,,,,,,,,,,,,,,,,
1,1,msg_timeout missing argument, -section,,,,,,,, -msg_timeout,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,
1,1,msg_timeout negative, -section,,,,,,,, -msg_timeout,-5,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,
,,,,,,,,,,,,,,,,,,,,,,,,,,
0,0,total_timeout 5, -section,,,,,,,,BLANK,, -total_timeout,5,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,
0,0,total_timeout 0, -section,,,,,,,,BLANK,, -total_timeout,0,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,
,,,,,,,,,,,,,,,,,,,,,,,,,,
1,1,total_timeout missing arg, -section,,,,,,,,BLANK,, -total_timeout,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,
1,1,total_timeout negative, -section,,,,,,,,BLANK,, -total_timeout,-5,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,
1,1,total_timeout integer out of range, -section,,,,,,,,BLANK,, -total_timeout,0x100000000000000000,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,
1,1,total_timeout floating point number, -section,,,,,,,,BLANK,, -total_timeout,0.5,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,
1,1,total_timeout non-digit, -section,,,,,,,,BLANK,, -total_timeout,asdf,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,
,,,,,,,,,,,,,,,,,,,,,,,,,,
1,1,tls_used not given, -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,,BLANK,, -tls_cert,EJBCACMPSignerTLS.p12, -tls_key,EJBCACMPSignerTLS.p12, -tls_keypass,pass:12345,BLANK,,BLANK,
1,-,handshake failure due to missing tls params, -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,, -tls_used,,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,
1,1,argument given for -tls_used, -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,, -tls_used,0,BLANK,,BLANK,,BLANK,,BLANK,,BLANK,
,,,,,,,,,,,,,,,,,,,,,,,,,,
0,-,tls_used given, -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,, -tls_used,, -tls_cert,EJBCACMPSignerTLS.p12, -tls_key,EJBCACMPSignerTLS.p12, -tls_keypass,pass:12345,BLANK,,BLANK,
0,-,tls with PEM credential files, -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,,-tls_used,, -tls_cert,EJBCACMPSignerTLS.crt, -tls_key,EJBCACMPSignerTLS.key.pem,BLANK,,BLANK,,BLANK,
TBD Keyfile does not match,TBD Keyfile does not match,tls .pem file with 1000 certs, -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,,-tls_used,, -tls_cert,big_EJBCACMPSignerTLS.crt.pem, -tls_key,EJBCACMPSignerTLS.key.pem,BLANK,,BLANK,,BLANK,
BIG TBD Keyfile does not match,TBD Keyfile does not match,tls big .pem file converted to p12, -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,,-tls_used,, -tls_cert,big_EJBCACMPSignerTLS.crt.pem.p12, -tls_key,big_EJBCACMPSignerTLS.crt.pem.p12, -tls_keypass,pass:12345,BLANK,,BLANK,
,,,,,,,,,,,,,,,,,,,,,,,,,,
1,-,tls no key, -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,,-tls_used,, -tls_cert,EJBCACMPSignerTLS.p12, -tls_key,, -tls_keypass,pass:12345,BLANK,,BLANK,
1,-,tls no cert, -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,,-tls_used,, -tls_cert,, -tls_key,EJBCACMPSignerTLS.p12, -tls_keypass,pass:12345,BLANK,,BLANK,
1,-,tls cert does not match key, -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,,-tls_used,, -tls_cert,EJBCACMPSignerIntermediate.p12, -tls_key,EJBCACMPSignerTLS.p12, -tls_keypass,pass:12345,BLANK,,BLANK,
1,-,tls key does not match cert, -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,,-tls_used,, -tls_cert,EJBCACMPSignerTLS.p12, -tls_key,signer.p12, -tls_keypass,pass:12345,BLANK,,BLANK,
1,-,tls wrong keypass, -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,,-tls_used,, -tls_cert,EJBCACMPSignerTLS.p12, -tls_key,EJBCACMPSignerTLS.p12, -tls_keypass,pass:123456,BLANK,,BLANK,
1,-,tls keypass prefix wrong, -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,,-tls_used,, -tls_cert,EJBCACMPSignerTLS.p12, -tls_key,EJBCACMPSignerTLS.p12, -tls_keypass,passo:12345,BLANK,,BLANK,
1,-,tls keypass empty password, -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,,-tls_used,, -tls_cert,EJBCACMPSignerTLS.p12, -tls_key,EJBCACMPSignerTLS.p12, -tls_keypass,pass:,BLANK,,BLANK,
1,-,tls keypass missing argument, -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,,-tls_used,, -tls_cert,EJBCACMPSignerTLS.p12, -tls_key,EJBCACMPSignerTLS.p12, -tls_keypass,,BLANK,,BLANK,
0,-,tls keypass no prefix, -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,,-tls_used,, -tls_cert,EJBCACMPSignerTLS.p12, -tls_key,EJBCACMPSignerTLS.p12, -tls_keypass,12345,BLANK,,BLANK,
1,-,tls no keypass, -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,,-tls_used,, -tls_cert,EJBCACMPSignerTLS.p12, -tls_cert,EJBCACMPSignerTLS.p12,BLANK,,BLANK,,BLANK,
1,-,tls no cert, -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,,BLANK,,-tls_used,, -tls_cert,EJBCACMPSignerTLS.p12, -tls_keypass,pass:12345,BLANK,,BLANK,
1,-,tls no key, -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,,-tls_used,, -tls_cert,EJBCACMPSignerTLS.p12,BLANK,, -tls_keypass,pass:12345,BLANK,,BLANK,
1,-,random file as tls_cert, -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,,-tls_used,, -tls_cert,random.bin, -tls_key,EJBCACMPSignerTLS.p12, -tls_keypass,pass:12345,BLANK,,BLANK,
1,-,random file as tls_key, -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,,-tls_used,, -tls_cert,EJBCACMPSignerTLS.p12, -tls_key,random.bin, -tls_keypass,pass:12345,BLANK,,BLANK,
1,-,random file as keypass, -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,,-tls_used,, -tls_cert,EJBCACMPSignerTLS.p12, -tls_key,EJBCACMPSignerTLS.p12, -tls_keypass,random.bin,BLANK,,BLANK,
1,-,expired tls_cert, -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,,-tls_used,, -tls_cert,EJBCACMPSignerTLS_expired.p12, -tls_key,EJBCACMPSignerTLS_expired.p12, -tls_keypass,pass:12345,BLANK,,BLANK,
0,-,TLS keypass from file, -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,,-tls_used,, -tls_cert,EJBCACMPSignerTLS.p12, -tls_key,EJBCACMPSignerTLS.p12, -tls_keypass,file:12345.txt,BLANK,,BLANK,
,,,,,,,,,,,,,,,,,,,,,,,,,,
0,-,tls host explicit host, -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,,-tls_used,, -tls_cert,EJBCACMPSignerTLS.p12, -tls_key,EJBCACMPSignerTLS.p12, -tls_keypass,pass:12345, -tls_trusted,EJBCAInfrastructureRootCAv10.crt, -tls_host,_SERVER_HOST
0,-,tls_trusted and no tls_host, -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,,-tls_used,, -tls_cert,EJBCACMPSignerTLS.p12, -tls_key,EJBCACMPSignerTLS.p12, -tls_keypass,pass:12345, -tls_trusted,EJBCAInfrastructureRootCAv10.crt,BLANK,
BIG TBD 0,BIG TBD 0,tls_trusted big cert file, -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,,-tls_used,, -tls_cert,EJBCACMPSignerTLS.p12, -tls_key,EJBCACMPSignerTLS.p12, -tls_keypass,pass:12345, -tls_trusted,big_EJBCAInfrastructureRootCAv10.crt,BLANK,
,,,,,,,,,,,,,,,,,,,,,,,,,,
TBD,TBD,tls expired cert, -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,,-tls_used,, -tls_cert,EJBCACMPSignerTLS.p12, -tls_key,EJBCACMPSignerTLS.p12, -tls_keypass,pass:12345, -tls_trusted,EJBCAInfrastructureRootCAv10_expired.crt,BLANK,
1,-,tls_host missing arg, -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,,-tls_used,, -tls_cert,EJBCACMPSignerTLS.p12, -tls_key,EJBCACMPSignerTLS.p12, -tls_keypass,pass:12345, -tls_trusted,EJBCAInfrastructureRootCAv10.crt, -tls_host,
1,-,wrong tls_host, -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,,-tls_used,, -tls_cert,EJBCACMPSignerTLS.p12, -tls_key,EJBCACMPSignerTLS.p12, -tls_keypass,pass:12345, -tls_trusted,EJBCAInfrastructureRootCAv10.crt, -tls_host,example.whatever
1,-,tls_host wrong suffix, -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,,-tls_used,, -tls_cert,EJBCACMPSignerTLS.p12, -tls_key,EJBCACMPSignerTLS.p12, -tls_keypass,pass:12345, -tls_trusted,EJBCAInfrastructureRootCAv10.crt, -tls_host,127.0.0.x
1,-,tls_host missing suffix, -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,,-tls_used,, -tls_cert,EJBCACMPSignerTLS.p12, -tls_key,EJBCACMPSignerTLS.p12, -tls_keypass,pass:12345, -tls_trusted,EJBCAInfrastructureRootCAv10.crt, -tls_host,127.0.0
1,-,tls_host bad IP address syntax: extra '.', -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,,-tls_used,, -tls_cert,EJBCACMPSignerTLS.p12, -tls_key,EJBCACMPSignerTLS.p12, -tls_keypass,pass:12345, -tls_trusted,EJBCAInfrastructureRootCAv10.crt, -tls_host,127.0.0..1
1,-,tls_host bad DNS name syntax: extra '.', -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,,-tls_used,, -tls_cert,EJBCACMPSignerTLS.p12, -tls_key,EJBCACMPSignerTLS.p12, -tls_keypass,pass:12345, -tls_trusted,EJBCAInfrastructureRootCAv10.crt, -tls_host,localhost..com
,,,,,,,,,,,,,,,,,,,,,,,,,,
TBD wrong key usage,-,tls certificate not suitable for TLS, -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,,-tls_used,, -tls_cert,signer.crt, -tls_key,signer.p12, -tls_keypass,pass:12345, -tls_trusted,EJBCAInfrastructureRootCAv10.crt,BLANK,
1,-,tls_cert non-existent file, -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,,-tls_used,, -tls_cert,idontexist, -tls_key,idontexist, -tls_keypass,pass:12345, -tls_trusted,EJBCAInfrastructureRootCAv10.crt,BLANK,
1,-,tls_cert empty file, -section,, -server,_SERVER_HOST:_SERVER_TLS,,,,,BLANK,,BLANK,,-tls_used,, -tls_cert,empty.txt, -tls_key,EJBCACMPSignerTLS.p12, -tls_keypass,pass:12345, -tls_trusted,EJBCAInfrastructureRootCAv10.crt,BLANK,
