[default]
batch = 1 # needed for cmp-dev
#proxy = 194.145.60.1:9400
total_timeout = 8 # prevent, e.g., infinite polling due to error
trusted = root.crt
newkey = newkey.pem
newkeypass = 
cmd = ir
out_trusted = trusted.crt
certout = test.cert.pem
policies = certificatePolicies
# verbosity = 7

############################# server configurations

[Mock] # the built-in OpenSSL CMP mock server
no_check_time = 1
server_cn = localhost
server_ip = 127.0.0.1
server_port = 1700
server_tls = 0
server_cert = signer.crt
server = $server_cn:$server_port
path = pkix/
ca_dn = /O=openssl_cmp
recipient = $ca_dn
server_dn = /O=openssl_cmp
expect_sender = $server_dn
subject = "/C=DE/O=Siemens AG/CN=test client"
pbm_secret = pass:SecretCmp
cert = signer.crt
key  = signer.p12
keypass = pass:12345
ignore_keyusage = 0
column = 0
sleep = 0

[EJBCA]
server_cn = ec2-204-236-244-127.compute-1.amazonaws.com
server_ip = 204.236.244.127
server_port = 80
server_tls = 443
server_cert = issuing.crt
server = $server_cn:$server_port
path = /ejbca/publicweb/cmp/ECCEndEntity
ca_dn = /CN=ECC Issuing CA v10/OU=For test purpose only/O=CMPforOpenSSL/C=DE
recipient = $ca_dn
subject = "/CN=ECC-EE/OU=For test purposes only/O=CMPforOpenSSL/C=DE"
pbm_secret = pass:SecretCmp
cert = signer.crt
key  = signer.p12
keypass = pass:12345
ignore_keyusage = 0
unprotected_errors = 1 # EJBCA sends error messages and negative responses without protection
column = 0
sleep = 1

[Insta]
server_cn = pki.certificate.fi
server_ip = 91.213.161.196
server_port = 8700
server_tls = 0
server_cert = issuing.crt
server = $server_cn:$server_port
path = pkix/
ca_dn = /C=FI/O=Insta Demo/CN=Insta Demo CA
recipient = $ca_dn
subject = /C=FI/O=Insta Demo/CN=ECC-EE
pbm_secret = pass:insta
ref = 3078
secret = $pbm_secret
key =
cert =
ignore_keyusage = 1
unprotected_errors = 0
crls = "../../../../../creds/crls/InstaDemoCA.crl"
column = 1
sleep = 4
# 3 is not sufficient for enrollment tests: sometimes leads to HTTP code 503 (Service Unavailable)

[SimpleLra] # this is a Siemens-only test configuration
#no_check_time = 1
#attime = 1564704000
server_cn = localhost
server_ip = 127.0.0.1
server_port = 9080
server_tls = 9443
server_cert = signer.crt
server = $server_cn:$server_port
# tls_used = 1 # must not be set for cmp-dev
tls_cert = EJBCACMPSignerTLS.p12
tls_key = $tls_cert
tls_keypass = pass:12345
tls_trusted = EJBCAInfrastructureRootCAv10.crt
path = cmp/PlaygroundECC/
ca_dn = /CN=PPKI Playground ECC Issuing CA v1.0/OU=Corporate Technology/OU=For internal test purposes only/O=Siemens/C=DE
recipient = $ca_dn
server_dn = /CN=Product PKI Playground CMP Signer/OU=PPKI Playground/OU=Corporate Technology/OU=For internal test purposes only/O=Siemens/C=DE
expect_sender = $server_dn
subject = /CN=ECC-EE/OU=PPKI Playground/OU=Corporate Technology/OU=For internal test purposes only/O=Siemens/C=DE
pbm_secret = pass:SecretCmp
cert = signer.crt
key  = signer.p12
keypass = pass:12345
ignore_keyusage = 0
unprotected_errors = 1 # EJBCA sends error messages and negative responses without protection
crls = "../../../../../creds/crls/PPKIPlaygroundInfrastructureIssuingCAv10.crl, ../../../../../creds/crls/PPKIPlaygroundECCRootCAv10.crl, ../../../../../creds/crls/PPKIPlaygroundInfrastructureRootCAv10.crl, ../../../../../creds/crls/PPKIPlaygroundRSARootCAv10.crl"
cdps = "https://ppki-playground.ct.siemens.com/ejbca/publicweb/webdist/certdist?cmd=crl&format=DER&issuer=CN=PPKI+Playground+Infrastructure+Issuing+CA+v1.0%2cOU=Corporate+Technology%2cOU=For+internal+test+purposes+only%2cO=Siemens%2cC=DE, https://ppki-playground.ct.siemens.com/ejbca/publicweb/webdist/certdist?cmd=crl&format=DER&issuer=CN=PPKI+Playground+Infrastructure+Root+CA+v1.0%2cOU=Corporate+Technology%2cOU=For+internal+test+purposes+only%2cO=Siemens%2cC=DE, http://ppki-playground.ct.siemens.com/ejbca/publicweb/webdist/certdist?cmd=crl&format=DER&issuer=CN=PPKI+Playground+ECC+Issuing+CA+v1.0%2cOU=Corporate+Technology%2cOU=For+internal+test+purposes+only%2cO=Siemens%2cC=DE, http://ppki-playground.ct.siemens.com/ejbca/publicweb/webdist/certdist?cmd=crl&format=DER&issuer=CN=PPKI+Playground+ECC+Root+CA+v1.0%2cOU=Corporate+Technology%2cOU=For+internal+test+purposes+only%2cO=Siemens%2cC=DE"
ocsp = "http://ppki-playground.ct.siemens.com/ejbca/publicweb/status/ocsp"
column = 0
sleep = 0

############################# aspects

[connection]
msg_timeout = 5
total_timeout =
# reset any per-CA TLS options to default:
tls_used =
tls_cert =
tls_key =
tls_keypass =
tls_trusted =
tls_host =
crls =
cdps =
ocsp =

[credentials]
ref =
secret =
cert =
key =
keypass =
extracerts =
geninfo = # TODO move geninfo tests to commands section
digest =
unprotected_requests =
crls =
cdps =
ocsp =

[verification]
# expect_sender =
srvcert =
trusted =
untrusted =
extracertsout =
crls =
cdps =
ocsp =

[commands]
cmd =
cacertsout =
infotype =
oldcert =
revreason =
crls =
cdps =
ocsp =

[enrollment]
cmd =
newkey =
newkeypass =
#subject =
issuer =
days =
reqexts =
sans =
san_nodefault = 0
#popo =
implicit_confirm = 0
disable_confirm = 0
certout =
out_trusted =
oldcert =
csr =
crls =
cdps =
ocsp =

[certstatus]
cmd = cr
secret = # force using signature-based protection
cert = signer.crt
key = signer.p12
keypass = pass:12345
# by default using crls, ocsp, and cdps as defined above
verbosity = 7

############################# extra cert template contents

[certificatePolicies]
certificatePolicies = "critical, @pkiPolicy"

[pkiPolicy]
policyIdentifier = 1.2.3.4

[reqexts]
basicConstraints = CA:FALSE
#basicConstraints = critical, CA:TRUE
keyUsage = critical, digitalSignature # keyAgreement, keyEncipherment, nonRepudiation
extendedKeyUsage = critical, clientAuth # serverAuth, codeSigning
#crlDistributionPoints = URI:http:
# authorityInfoAccess = URI:http:
subjectAltName = @alt_names

[alt_names]
DNS.0 = localhost
IP.0 = 127.0.0.1
IP.1 = 192.168.0.1
URI.0 = http://192.168.0.2

[reqexts_invalidkey]
subjectAltName = @alt_names_3

[alt_names_3]
DNS.0 = localhost
DNS.1 = example.com
DNS.2 = example2.com
DNS__3 = example3.com
