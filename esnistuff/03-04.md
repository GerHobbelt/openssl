
# Notes on the draft-03 to draft-04 transition

The [diff](https://tools.ietf.org/rfcdiff?url2=draft-ietf-tls-esni-04.txt)

- more detail on split-mode, but not that convincing so far

- ESNIKeys -> ESNIRecord change, hmm
    - why add 2nd extensibility field?
    - AddressSet moves to outer extensions struct - meh
    - mandatory extensions via code points - yuk!
        - turns out I missed that was in -03 already (and maybe before;-)
        - it's still dim!
    - ESNIRecord vs ESNIKeys versioning - can't support 0xff01 in ESNIRecord

- ESNIKeys changes:
    - delete checksum and not before/after - yay!
 
- record_digest in encrypted_server_name extension based on other octets

- key and iv label changes - check 'em out

- ServerNameList -> dns_name in PaddedServerNameList

- HRR processing - I've never checked it out, so ought do

- Greasing++ - add client code  
    - not sure how to handle server extension value if all client did i
        was grease
    - what if client wants to both grease and play the real game?

- added trial decryption and BS record_digest which is fine
    - how does one "omit" the record_digest, as claimed?
